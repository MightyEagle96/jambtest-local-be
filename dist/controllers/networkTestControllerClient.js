'use strict';const a11_0x4718bd=a11_0xc664;(function(_0x551238,_0xf5b3a6){const _0x49ee2e=a11_0xc664,_0x46a362=_0x551238();while(!![]){try{const _0x5e5df9=parseInt(_0x49ee2e(0xa3))/0x1*(-parseInt(_0x49ee2e(0xbe))/0x2)+-parseInt(_0x49ee2e(0xb4))/0x3+-parseInt(_0x49ee2e(0x90))/0x4+-parseInt(_0x49ee2e(0x9d))/0x5+-parseInt(_0x49ee2e(0xcc))/0x6*(parseInt(_0x49ee2e(0xb7))/0x7)+-parseInt(_0x49ee2e(0xb1))/0x8+parseInt(_0x49ee2e(0xad))/0x9*(parseInt(_0x49ee2e(0x9c))/0xa);if(_0x5e5df9===_0xf5b3a6)break;else _0x46a362['push'](_0x46a362['shift']());}catch(_0x4b48db){_0x46a362['push'](_0x46a362['shift']());}}}(a11_0x1095,0xb6637));var __awaiter=this&&this[a11_0x4718bd(0xc3)]||function(_0x1bf7ea,_0x461783,_0x184f04,_0x33ba12){function _0x2991fe(_0x393b7c){return _0x393b7c instanceof _0x184f04?_0x393b7c:new _0x184f04(function(_0x558e80){_0x558e80(_0x393b7c);});}return new(_0x184f04||(_0x184f04=Promise))(function(_0x25730f,_0x844b44){const _0x5e5f71=a11_0xc664;function _0x4ea6fd(_0x43be97){const _0x529f27=a11_0xc664;try{_0x19b984(_0x33ba12[_0x529f27(0xa0)](_0x43be97));}catch(_0x3e9ce0){_0x844b44(_0x3e9ce0);}}function _0x46fc04(_0xb7e479){const _0xb70cff=a11_0xc664;try{_0x19b984(_0x33ba12[_0xb70cff(0x85)](_0xb7e479));}catch(_0x498711){_0x844b44(_0x498711);}}function _0x19b984(_0x1b5d2b){const _0x3acbfe=a11_0xc664;_0x1b5d2b[_0x3acbfe(0x8b)]?_0x25730f(_0x1b5d2b[_0x3acbfe(0xba)]):_0x2991fe(_0x1b5d2b[_0x3acbfe(0xba)])[_0x3acbfe(0xc5)](_0x4ea6fd,_0x46fc04);}_0x19b984((_0x33ba12=_0x33ba12[_0x5e5f71(0x8d)](_0x1bf7ea,_0x461783||[]))['next']());});},__importDefault=this&&this[a11_0x4718bd(0xca)]||function(_0x24dc8b){const _0x1f85ac=a11_0x4718bd;return _0x24dc8b&&_0x24dc8b[_0x1f85ac(0xab)]?_0x24dc8b:{'default':_0x24dc8b};};Object[a11_0x4718bd(0xa7)](exports,a11_0x4718bd(0xab),{'value':!![]}),exports['viewMyComputerResponse']=exports[a11_0x4718bd(0xae)]=exports[a11_0x4718bd(0xa6)]=exports['sendResponses']=exports[a11_0x4718bd(0x8a)]=exports[a11_0x4718bd(0xa5)]=exports[a11_0x4718bd(0x7f)]=void 0x0;const networkTest_1=__importDefault(require(a11_0x4718bd(0x9f))),computerModel_1=__importDefault(require(a11_0x4718bd(0xc0))),centreModel_1=__importDefault(require(a11_0x4718bd(0x86))),DataQueue_1=require(a11_0x4718bd(0x7e)),networkTestResponse_1=__importDefault(require('../models/networkTestResponse')),questions_1=__importDefault(require(a11_0x4718bd(0x83))),activeTestIntervals=new Map(),viewNetworkTest=(_0x202f27,_0x194a67)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x11e87d=a11_0x4718bd,_0x39c37f=yield networkTest_1['default'][_0x11e87d(0xc6)](_0x202f27[_0x11e87d(0x88)]['id']);if(!_0x39c37f)return _0x194a67[_0x11e87d(0xac)](0x190)[_0x11e87d(0xbd)](_0x11e87d(0xc2));_0x194a67[_0x11e87d(0xbd)](_0x39c37f);});exports[a11_0x4718bd(0x7f)]=viewNetworkTest;const errorMessages={'noCentre':a11_0x4718bd(0xa1),'noComputer':'Computer\x20not\x20yet\x20registered','noActiveTest':a11_0x4718bd(0x7c),'computerFlagged':'This\x20computer\x20has\x20been\x20flagged\x20for\x20an\x20infraction','notUploaded':a11_0x4718bd(0x84),'alreadyTested':a11_0x4718bd(0x95)},networkTestValidation=(_0x536f10,_0x1b1536,_0x3d3582)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2680b1=a11_0x4718bd;var _0x46a3d9,_0x4e0971;const _0x2f5f65=yield centreModel_1[_0x2680b1(0x92)]['findOne'](),_0x43ab45=_0x536f10['body'],_0x48116c=(_0x46a3d9=_0x43ab45[_0x2680b1(0x9b)])===null||_0x46a3d9===void 0x0?void 0x0:_0x46a3d9[_0x2680b1(0xb6)](),_0x39c225=(_0x4e0971=_0x43ab45[_0x2680b1(0xb2)])===null||_0x4e0971===void 0x0?void 0x0:_0x4e0971[_0x2680b1(0xb6)](),_0x5e312a=(_0x43ab45['macAddresses']||[])[_0x2680b1(0xcd)](_0x51f7b0=>_0x51f7b0[_0x2680b1(0xb6)]());if(!_0x2f5f65)return _0x1b1536[_0x2680b1(0xac)](0x190)[_0x2680b1(0xbd)](errorMessages[_0x2680b1(0x9a)]);const _0x2d44d7=yield computerModel_1[_0x2680b1(0x92)]['findOne']({'$and':[{'serialNumber':_0x48116c},{'processorId':_0x39c225},{'macAddresses':{'$in':_0x5e312a}}]});if(!_0x2d44d7)return _0x1b1536[_0x2680b1(0xac)](0x190)['send'](errorMessages[_0x2680b1(0xd0)]);if(_0x2d44d7[_0x2680b1(0xac)]!==_0x2680b1(0x7d))return _0x1b1536[_0x2680b1(0xac)](0x190)['send'](errorMessages['notUploaded']);if(_0x2d44d7[_0x2680b1(0xa8)])return _0x1b1536['status'](0x190)[_0x2680b1(0xbd)](errorMessages[_0x2680b1(0x97)]);const _0x203cc0=yield networkTest_1[_0x2680b1(0x92)][_0x2680b1(0xc4)]({'active':!![]});if(!_0x203cc0)return _0x1b1536[_0x2680b1(0xac)](0x190)[_0x2680b1(0xbd)](errorMessages[_0x2680b1(0xa2)]);if(_0x203cc0){const _0x17e160=yield networkTestResponse_1[_0x2680b1(0x92)][_0x2680b1(0xc4)]({'computer':_0x2d44d7[_0x2680b1(0xc7)][_0x2680b1(0xbc)](),'networkTest':_0x203cc0[_0x2680b1(0xc7)]['toString'](),'status':_0x2680b1(0xc1)});if(_0x17e160)return _0x1b1536['status'](0x190)[_0x2680b1(0xbd)](errorMessages[_0x2680b1(0x8f)]);}_0x536f10['headers'][_0x2680b1(0xaf)]=_0x2d44d7[_0x2680b1(0xc7)][_0x2680b1(0xbc)](),_0x536f10[_0x2680b1(0xc9)][_0x2680b1(0xb9)]=_0x203cc0[_0x2680b1(0xc7)][_0x2680b1(0xbc)](),_0x3d3582();});function a11_0xc664(_0xdd6b3a,_0x98e3af){const _0x10955f=a11_0x1095();return a11_0xc664=function(_0xc6648d,_0x48b261){_0xc6648d=_0xc6648d-0x7c;let _0x4daff2=_0x10955f[_0xc6648d];return _0x4daff2;},a11_0xc664(_0xdd6b3a,_0x98e3af);}exports['networkTestValidation']=networkTestValidation;const dataQueue=new DataQueue_1[(a11_0x4718bd(0xc8))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),beginNetworkTest=(_0x4b9d8c,_0x444fdd)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xba3c2a=a11_0x4718bd;_0x444fdd[_0xba3c2a(0xbd)]({'networkTest':_0x4b9d8c[_0xba3c2a(0xc9)][_0xba3c2a(0xb9)],'computer':_0x4b9d8c['headers'][_0xba3c2a(0xaf)]}),dataQueue[_0xba3c2a(0x94)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2e8b77=_0xba3c2a,_0x4a30cd=yield networkTest_1['default'][_0x2e8b77(0xc6)](_0x4b9d8c[_0x2e8b77(0xc9)][_0x2e8b77(0xb9)]),_0x52aa94=yield networkTestResponse_1[_0x2e8b77(0x92)][_0x2e8b77(0xc4)]({'computer':_0x4b9d8c['headers'][_0x2e8b77(0xaf)],'networkTest':_0x4b9d8c[_0x2e8b77(0xc9)]['networktest']});!_0x52aa94&&_0x4a30cd&&(yield networkTestResponse_1['default'][_0x2e8b77(0xb5)]({'computer':_0x4b9d8c[_0x2e8b77(0xc9)][_0x2e8b77(0xaf)],'networkTest':_0x4b9d8c[_0x2e8b77(0xc9)]['networktest'],'ipAddress':_0x4b9d8c['ip'],'responses':0x0,'timeLeft':_0x4a30cd[_0x2e8b77(0x8c)],'loggedInAt':new Date()}));}));});exports[a11_0x4718bd(0x8a)]=beginNetworkTest;const responseQueue=new DataQueue_1[(a11_0x4718bd(0xc8))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),sendResponses=(_0x3dd407,_0x564d7b)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xe141=a11_0x4718bd;try{const _0x3359f3=yield networkTest_1['default'][_0xe141(0xc4)]({'active':!![]});if(!_0x3359f3)return _0x564d7b[_0xe141(0x98)](0x194);yield responseQueue[_0xe141(0x94)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4da06d=_0xe141,{computer:_0x22149b,networktest:_0x251624,timeLeft:_0x7ba1ab}=_0x3dd407[_0x4da06d(0x81)],_0x38e8f=yield networkTest_1[_0x4da06d(0x92)][_0x4da06d(0xc6)](_0x251624);if(!_0x38e8f)return console[_0x4da06d(0x99)](_0x4da06d(0xbf),_0x251624),_0x564d7b[_0x4da06d(0xac)](0x194)[_0x4da06d(0xbd)](_0x4da06d(0xb8));const _0x3b124c=yield networkTestResponse_1[_0x4da06d(0x92)][_0x4da06d(0xc4)]({'computer':_0x22149b,'networkTest':_0x251624});if(!_0x3b124c)return _0x564d7b['status'](0x194)['send']({'message':_0x4da06d(0xaa)});_0x3b124c[_0x4da06d(0xcf)]+0x1<=_0x38e8f[_0x4da06d(0xce)]&&(_0x3b124c[_0x4da06d(0xcf)]+=0x1),_0x3b124c[_0x4da06d(0x91)]=_0x7ba1ab,_0x3b124c[_0x4da06d(0xac)]=_0x4da06d(0xb0),yield _0x3b124c[_0x4da06d(0x9e)](),_0x564d7b[_0x4da06d(0xbd)](_0x4da06d(0xcb));}));}catch(_0x50128e){console[_0xe141(0xb3)](_0xe141(0x96),_0x50128e),_0x564d7b[_0xe141(0xac)](0x1f4)[_0xe141(0xbd)]({'message':_0xe141(0xa4)});}});exports[a11_0x4718bd(0x82)]=sendResponses;const questionAndResponseCount=(_0x27f820,_0x2c4f6c)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x54e896=a11_0x4718bd,[_0x3727c5,_0x29a878]=yield Promise['all']([networkTestResponse_1[_0x54e896(0x92)][_0x54e896(0xc4)]({'computer':_0x27f820[_0x54e896(0x81)][_0x54e896(0xaf)],'networkTest':_0x27f820[_0x54e896(0x81)][_0x54e896(0xb9)]}),networkTest_1[_0x54e896(0x92)]['findById'](_0x27f820[_0x54e896(0x81)][_0x54e896(0xb9)])]);if(!_0x3727c5)return _0x2c4f6c['status'](0x194)[_0x54e896(0xbd)](_0x54e896(0x8e));if(!_0x29a878)return _0x2c4f6c[_0x54e896(0xac)](0x194)[_0x54e896(0xbd)]('Test\x20not\x20found');function _0x253782(){const _0x56280a=_0x54e896,_0x273509=Math[_0x56280a(0x87)](Math[_0x56280a(0xbb)]()*questions_1[_0x56280a(0x92)][_0x56280a(0x93)]);return questions_1[_0x56280a(0x92)][_0x273509];}_0x2c4f6c[_0x54e896(0xbd)](Object['assign'](Object[_0x54e896(0x89)]({},_0x253782()),{'responses':_0x3727c5['responses'],'maxResponses':_0x29a878[_0x54e896(0xce)]}));});function a11_0x1095(){const _0xb67323=['computer','connected','4296824oTAYKm','processorId','error','4390743FHSuoF','create','toLowerCase','170842WselbW','No\x20matching\x20test\x20found','networktest','value','random','toString','send','25794RSJzJz','No\x20matching\x20test\x20found\x20for:','../models/computerModel','ended','Test\x20not\x20found','__awaiter','findOne','then','findById','_id','ConcurrentJobQueue','headers','__importDefault','Success','312qmVoRh','map','maxResponses','responses','noComputer','There\x20is\x20no\x20active\x20network\x20test','uploaded','./DataQueue','viewNetworkTest','viewMyComputerResponse','body','sendResponses','./questions','This\x20computer\x20is\x20not\x20yet\x20registered\x20on\x20the\x20JAMB\x20test\x20network','throw','../models/centreModel','floor','params','assign','beginNetworkTest','done','duration','apply','Response\x20not\x20found','alreadyTested','1817864CJWihU','timeLeft','default','length','enqueue','This\x20computer\x20has\x20already\x20been\x20tested','Error\x20in\x20sendResponses:','computerFlagged','sendStatus','log','noCentre','serialNumber','380330seypQa','1637725VnMxgI','save','../models/networkTest','next','No\x20centre\x20found,\x20contact\x20administrator','noActiveTest','85tbXGZp','Server\x20error','networkTestValidation','questionAndResponseCount','defineProperty','flagged','networkTest','No\x20matching\x20response\x20found','__esModule','status','1395kMoeIJ','endNetworkTest'];a11_0x1095=function(){return _0xb67323;};return a11_0x1095();}exports[a11_0x4718bd(0xa6)]=questionAndResponseCount;const endQueue=new DataQueue_1[(a11_0x4718bd(0xc8))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),endNetworkTest=(_0x1bff61,_0x2f05c1)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x178b23=a11_0x4718bd,_0x3d8c8b=yield networkTest_1['default'][_0x178b23(0xc4)]({'active':!![]});if(!_0x3d8c8b)return _0x2f05c1[_0x178b23(0x98)](0x194);endQueue[_0x178b23(0x94)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xa9da96=_0x178b23,{computer:_0x35c79c,networktest:_0x11f85c}=_0x1bff61['body'],_0xa0c29f=yield networkTest_1[_0xa9da96(0x92)]['findById'](_0x11f85c);if(!_0xa0c29f)return console['log']('No\x20matching\x20test\x20found\x20for:',_0x11f85c),_0x2f05c1[_0xa9da96(0x98)](0x194);const _0x2669bd=yield networkTestResponse_1[_0xa9da96(0x92)][_0xa9da96(0xc4)]({'computer':_0x35c79c,'networkTest':_0x11f85c});if(!_0x2669bd)return _0x2f05c1[_0xa9da96(0x98)](0x194);_0x2669bd[_0xa9da96(0xcf)]+0x1<=_0xa0c29f[_0xa9da96(0xce)]&&(_0x2669bd[_0xa9da96(0xcf)]+=0x1),_0x2669bd[_0xa9da96(0x91)]=0x0,_0x2669bd['status']=_0xa9da96(0xc1),yield _0x2669bd['save'](),_0x2f05c1[_0xa9da96(0xbd)]('Success');}));});exports[a11_0x4718bd(0xae)]=endNetworkTest;const viewMyComputerResponse=(_0x53f8fd,_0xc5521b)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5ae45c=a11_0x4718bd,_0xcf2b66=yield networkTestResponse_1['default'][_0x5ae45c(0xc4)]({'computer':_0x53f8fd[_0x5ae45c(0xc9)][_0x5ae45c(0xaf)],'networkTest':_0x53f8fd[_0x5ae45c(0xc9)][_0x5ae45c(0xb9)]})['populate']([_0x5ae45c(0xa9),'computer']);if(!_0xcf2b66)return _0xc5521b[_0x5ae45c(0xac)](0x194)[_0x5ae45c(0xbd)]('Response\x20not\x20found');_0xc5521b[_0x5ae45c(0xbd)](_0xcf2b66);});exports[a11_0x4718bd(0x80)]=viewMyComputerResponse;