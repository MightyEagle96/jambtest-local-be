'use strict';function a9_0x563e(_0x8d3950,_0x4cc8a0){const _0x1572b5=a9_0x1572();return a9_0x563e=function(_0x563ea5,_0xfe82cf){_0x563ea5=_0x563ea5-0x84;let _0x414670=_0x1572b5[_0x563ea5];return _0x414670;},a9_0x563e(_0x8d3950,_0x4cc8a0);}const a9_0x3fbc01=a9_0x563e;(function(_0x402c87,_0x45a50b){const _0x4a265f=a9_0x563e,_0x54b4d6=_0x402c87();while(!![]){try{const _0x5533b5=parseInt(_0x4a265f(0x8d))/0x1*(-parseInt(_0x4a265f(0xb7))/0x2)+parseInt(_0x4a265f(0x96))/0x3*(-parseInt(_0x4a265f(0x99))/0x4)+parseInt(_0x4a265f(0xc9))/0x5*(parseInt(_0x4a265f(0xc7))/0x6)+parseInt(_0x4a265f(0xcc))/0x7+-parseInt(_0x4a265f(0xb1))/0x8+parseInt(_0x4a265f(0xac))/0x9*(-parseInt(_0x4a265f(0x9c))/0xa)+parseInt(_0x4a265f(0x91))/0xb;if(_0x5533b5===_0x45a50b)break;else _0x54b4d6['push'](_0x54b4d6['shift']());}catch(_0x487bb1){_0x54b4d6['push'](_0x54b4d6['shift']());}}}(a9_0x1572,0xe3865));var __awaiter=this&&this[a9_0x3fbc01(0xad)]||function(_0x19d30c,_0x5d0506,_0x6e410a,_0x267023){function _0x2ae787(_0x2e8895){return _0x2e8895 instanceof _0x6e410a?_0x2e8895:new _0x6e410a(function(_0x379de6){_0x379de6(_0x2e8895);});}return new(_0x6e410a||(_0x6e410a=Promise))(function(_0x53424b,_0x4f9c54){const _0x3ea5a7=a9_0x563e;function _0x267539(_0x3f49ab){const _0x132a31=a9_0x563e;try{_0x13f004(_0x267023[_0x132a31(0x93)](_0x3f49ab));}catch(_0x305589){_0x4f9c54(_0x305589);}}function _0x4e4def(_0x1f241e){const _0x137e37=a9_0x563e;try{_0x13f004(_0x267023[_0x137e37(0xc8)](_0x1f241e));}catch(_0x4f45f7){_0x4f9c54(_0x4f45f7);}}function _0x13f004(_0x4c3a08){const _0x10059c=a9_0x563e;_0x4c3a08[_0x10059c(0xaa)]?_0x53424b(_0x4c3a08['value']):_0x2ae787(_0x4c3a08[_0x10059c(0x86)])[_0x10059c(0xcd)](_0x267539,_0x4e4def);}_0x13f004((_0x267023=_0x267023['apply'](_0x19d30c,_0x5d0506||[]))[_0x3ea5a7(0x93)]());});},__importDefault=this&&this[a9_0x3fbc01(0x97)]||function(_0x47cb24){const _0x5d79c1=a9_0x3fbc01;return _0x47cb24&&_0x47cb24[_0x5d79c1(0xb4)]?_0x47cb24:{'default':_0x47cb24};};Object[a9_0x3fbc01(0xa5)](exports,a9_0x3fbc01(0xb4),{'value':!![]}),exports['viewMyComputerResponse']=exports[a9_0x3fbc01(0xc4)]=exports[a9_0x3fbc01(0xd4)]=exports[a9_0x3fbc01(0xc0)]=exports[a9_0x3fbc01(0xa1)]=exports[a9_0x3fbc01(0x95)]=exports[a9_0x3fbc01(0xcf)]=void 0x0;const networkTest_1=__importDefault(require('../models/networkTest')),computerModel_1=__importDefault(require(a9_0x3fbc01(0x98))),centreModel_1=__importDefault(require(a9_0x3fbc01(0xc6))),DataQueue_1=require(a9_0x3fbc01(0xd1)),networkTestResponse_1=__importDefault(require(a9_0x3fbc01(0xb0))),questions_1=__importDefault(require(a9_0x3fbc01(0x9e))),activeTestIntervals=new Map(),viewNetworkTest=(_0x1a701,_0x3ed768)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2743e8=a9_0x3fbc01,_0x23329d=yield networkTest_1[_0x2743e8(0xc5)][_0x2743e8(0xc1)](_0x1a701[_0x2743e8(0xa6)]['id']);if(!_0x23329d)return _0x3ed768['status'](0x190)[_0x2743e8(0xa8)](_0x2743e8(0xb6));_0x3ed768[_0x2743e8(0xa8)](_0x23329d);});exports['viewNetworkTest']=viewNetworkTest;const errorMessages={'noCentre':a9_0x3fbc01(0xae),'noComputer':a9_0x3fbc01(0x8e),'noActiveTest':a9_0x3fbc01(0xbe),'computerFlagged':a9_0x3fbc01(0xba),'notUploaded':a9_0x3fbc01(0x8a),'alreadyTested':a9_0x3fbc01(0xa0)},networkTestValidation=(_0x593f21,_0x136dc7,_0x29540c)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5cd509=a9_0x3fbc01;var _0x1d1d0c,_0x10f30f;const _0x2b4a56=yield centreModel_1[_0x5cd509(0xc5)][_0x5cd509(0x89)](),_0x215a1d=_0x593f21[_0x5cd509(0xb8)],_0x2e2b4b=(_0x1d1d0c=_0x215a1d[_0x5cd509(0xa9)])===null||_0x1d1d0c===void 0x0?void 0x0:_0x1d1d0c[_0x5cd509(0xca)](),_0x3db354=(_0x10f30f=_0x215a1d['processorId'])===null||_0x10f30f===void 0x0?void 0x0:_0x10f30f[_0x5cd509(0xca)](),_0x2585d1=(_0x215a1d[_0x5cd509(0x9b)]||[])['map'](_0x346afe=>_0x346afe['toLowerCase']());if(!_0x2b4a56)return _0x136dc7[_0x5cd509(0xb9)](0x190)[_0x5cd509(0xa8)](errorMessages[_0x5cd509(0x84)]);const _0x55aafb=yield computerModel_1[_0x5cd509(0xc5)]['findOne']({'$and':[{'serialNumber':_0x2e2b4b},{'processorId':_0x3db354},{'macAddresses':{'$in':_0x2585d1}}]});if(!_0x55aafb)return _0x136dc7['status'](0x190)['send'](errorMessages[_0x5cd509(0xbc)]);if(_0x55aafb[_0x5cd509(0xb9)]!==_0x5cd509(0x94))return _0x136dc7[_0x5cd509(0xb9)](0x190)[_0x5cd509(0xa8)](errorMessages[_0x5cd509(0xb3)]);if(_0x55aafb['flagged'])return _0x136dc7[_0x5cd509(0xb9)](0x190)[_0x5cd509(0xa8)](errorMessages[_0x5cd509(0xaf)]);const _0x353ec2=yield networkTest_1[_0x5cd509(0xc5)][_0x5cd509(0x89)]({'active':!![]});if(!_0x353ec2)return _0x136dc7[_0x5cd509(0xb9)](0x190)['send'](errorMessages[_0x5cd509(0xa7)]);if(_0x353ec2){const _0x55923f=yield networkTestResponse_1['default']['findOne']({'computer':_0x55aafb[_0x5cd509(0xc3)][_0x5cd509(0x90)](),'networkTest':_0x353ec2[_0x5cd509(0xc3)]['toString'](),'status':'ended'});if(_0x55923f)return _0x136dc7['status'](0x190)[_0x5cd509(0xa8)](errorMessages['alreadyTested']);}_0x593f21[_0x5cd509(0xbf)]['computer']=_0x55aafb['_id'][_0x5cd509(0x90)](),_0x593f21[_0x5cd509(0xbf)][_0x5cd509(0xce)]=_0x353ec2[_0x5cd509(0xc3)][_0x5cd509(0x90)](),_0x29540c();});exports[a9_0x3fbc01(0x95)]=networkTestValidation;const dataQueue=new DataQueue_1[(a9_0x3fbc01(0x88))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),beginNetworkTest=(_0x42a323,_0x32bb61)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x6f996c=a9_0x3fbc01;_0x32bb61[_0x6f996c(0xa8)]({'networkTest':_0x42a323[_0x6f996c(0xbf)][_0x6f996c(0xce)],'computer':_0x42a323[_0x6f996c(0xbf)]['computer']}),dataQueue[_0x6f996c(0xa3)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4276fa=_0x6f996c,_0x5513f3=yield networkTest_1[_0x4276fa(0xc5)][_0x4276fa(0xc1)](_0x42a323[_0x4276fa(0xbf)]['networktest']),_0x5a3c51=yield networkTestResponse_1['default'][_0x4276fa(0x89)]({'computer':_0x42a323['headers'][_0x4276fa(0x92)],'networkTest':_0x42a323['headers'][_0x4276fa(0xce)]});!_0x5a3c51&&_0x5513f3&&(yield networkTestResponse_1[_0x4276fa(0xc5)][_0x4276fa(0xa2)]({'computer':_0x42a323[_0x4276fa(0xbf)][_0x4276fa(0x92)],'networkTest':_0x42a323[_0x4276fa(0xbf)]['networktest'],'ipAddress':_0x42a323['ip'],'responses':0x0,'timeLeft':_0x5513f3[_0x4276fa(0x8f)],'loggedInAt':new Date()}));}));});exports['beginNetworkTest']=beginNetworkTest;const responseQueue=new DataQueue_1['ConcurrentJobQueue']({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),sendResponses=(_0x58c6ae,_0x1f721f)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x53f908=a9_0x3fbc01;try{const _0x35cd9f=yield networkTest_1[_0x53f908(0xc5)][_0x53f908(0x89)]({'active':!![]});if(!_0x35cd9f)return _0x1f721f[_0x53f908(0xb2)](0x194);yield responseQueue[_0x53f908(0xa3)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x37a4f3=_0x53f908,{computer:_0x15e150,networktest:_0x3a2234,timeLeft:_0x46290f}=_0x58c6ae[_0x37a4f3(0xb8)],_0x39f4ee=yield networkTest_1[_0x37a4f3(0xc5)]['findById'](_0x3a2234);if(!_0x39f4ee)return console[_0x37a4f3(0x9d)]('No\x20matching\x20test\x20found\x20for:',_0x3a2234),_0x1f721f[_0x37a4f3(0xb9)](0x194)['send'](_0x37a4f3(0xd3));const _0x3824e7=yield networkTestResponse_1[_0x37a4f3(0xc5)]['findOne']({'computer':_0x15e150,'networkTest':_0x3a2234});if(!_0x3824e7)return _0x1f721f[_0x37a4f3(0xb9)](0x194)[_0x37a4f3(0xa8)]({'message':'No\x20matching\x20response\x20found'});_0x3824e7[_0x37a4f3(0x9a)]+0x1<=_0x39f4ee[_0x37a4f3(0x9f)]&&(_0x3824e7['responses']+=0x1),_0x3824e7['timeLeft']=_0x46290f,_0x3824e7['status']='connected',yield _0x3824e7[_0x37a4f3(0xc2)](),_0x1f721f[_0x37a4f3(0xa8)](_0x37a4f3(0xab));}));}catch(_0x4a62fc){console[_0x53f908(0xd2)](_0x53f908(0x8c),_0x4a62fc),_0x1f721f[_0x53f908(0xb9)](0x1f4)[_0x53f908(0xa8)]({'message':'Server\x20error'});}});exports['sendResponses']=sendResponses;const questionAndResponseCount=(_0x1cf754,_0x233214)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x302a93=a9_0x3fbc01,[_0x4697b1,_0x1992c9]=yield Promise['all']([networkTestResponse_1[_0x302a93(0xc5)]['findOne']({'computer':_0x1cf754['body'][_0x302a93(0x92)],'networkTest':_0x1cf754[_0x302a93(0xb8)][_0x302a93(0xce)]}),networkTest_1[_0x302a93(0xc5)][_0x302a93(0xc1)](_0x1cf754[_0x302a93(0xb8)][_0x302a93(0xce)])]);if(!_0x4697b1)return _0x233214[_0x302a93(0xb9)](0x194)[_0x302a93(0xa8)](_0x302a93(0xcb));if(!_0x1992c9)return _0x233214[_0x302a93(0xb9)](0x194)[_0x302a93(0xa8)]('Test\x20not\x20found');function _0x13ee5a(){const _0x23e8ff=_0x302a93,_0x5b0ea9=Math[_0x23e8ff(0xd0)](Math[_0x23e8ff(0xbd)]()*questions_1['default'][_0x23e8ff(0xbb)]);return questions_1[_0x23e8ff(0xc5)][_0x5b0ea9];}_0x233214['send'](Object[_0x302a93(0x8b)](Object[_0x302a93(0x8b)]({},_0x13ee5a()),{'responses':_0x4697b1['responses'],'maxResponses':_0x1992c9[_0x302a93(0x9f)]}));});function a9_0x1572(){const _0x136f80=['findOne','This\x20computer\x20is\x20not\x20yet\x20registered\x20on\x20the\x20JAMB\x20test\x20network','assign','Error\x20in\x20sendResponses:','296wpFNaG','Computer\x20not\x20yet\x20registered','duration','toString','5125978iBrdhp','computer','next','uploaded','networkTestValidation','2076YmBOiE','__importDefault','../models/computerModel','4000COvcbn','responses','macAddresses','82000IqVGpY','log','./questions','maxResponses','This\x20computer\x20has\x20already\x20been\x20tested','beginNetworkTest','create','enqueue','networkTest','defineProperty','params','noActiveTest','send','serialNumber','done','Success','252UigRWZ','__awaiter','No\x20centre\x20found,\x20contact\x20administrator','computerFlagged','../models/networkTestResponse','786256GfWsmd','sendStatus','notUploaded','__esModule','No\x20matching\x20test\x20found\x20for:','Test\x20not\x20found','426sJUpQd','body','status','This\x20computer\x20has\x20been\x20flagged\x20for\x20an\x20infraction','length','noComputer','random','There\x20is\x20no\x20active\x20network\x20test','headers','sendResponses','findById','save','_id','endNetworkTest','default','../models/centreModel','366ZGAMkN','throw','99445wSBEfM','toLowerCase','Response\x20not\x20found','2349508oEQeBE','then','networktest','viewNetworkTest','floor','./DataQueue','error','No\x20matching\x20test\x20found','questionAndResponseCount','noCentre','populate','value','timeLeft','ConcurrentJobQueue'];a9_0x1572=function(){return _0x136f80;};return a9_0x1572();}exports['questionAndResponseCount']=questionAndResponseCount;const endQueue=new DataQueue_1[(a9_0x3fbc01(0x88))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),endNetworkTest=(_0x507774,_0x41f3ff)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x589c35=a9_0x3fbc01,_0x550ebb=yield networkTest_1[_0x589c35(0xc5)][_0x589c35(0x89)]({'active':!![]});if(!_0x550ebb)return _0x41f3ff['sendStatus'](0x194);endQueue['enqueue'](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x311e53=_0x589c35,{computer:_0x3c6e5,networktest:_0x2d3171}=_0x507774[_0x311e53(0xb8)],_0x1c69f9=yield networkTest_1['default']['findById'](_0x2d3171);if(!_0x1c69f9)return console[_0x311e53(0x9d)](_0x311e53(0xb5),_0x2d3171),_0x41f3ff[_0x311e53(0xb2)](0x194);const _0x41262a=yield networkTestResponse_1[_0x311e53(0xc5)]['findOne']({'computer':_0x3c6e5,'networkTest':_0x2d3171});if(!_0x41262a)return _0x41f3ff[_0x311e53(0xb2)](0x194);_0x41262a['responses']+0x1<=_0x1c69f9[_0x311e53(0x9f)]&&(_0x41262a[_0x311e53(0x9a)]+=0x1),_0x41262a[_0x311e53(0x87)]=0x0,_0x41262a[_0x311e53(0xb9)]='ended',yield _0x41262a[_0x311e53(0xc2)](),_0x41f3ff[_0x311e53(0xa8)]('Success');}));});exports[a9_0x3fbc01(0xc4)]=endNetworkTest;const viewMyComputerResponse=(_0x58ead4,_0x359c1e)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2df12e=a9_0x3fbc01,_0x20f62a=yield networkTestResponse_1['default'][_0x2df12e(0x89)]({'computer':_0x58ead4[_0x2df12e(0xbf)]['computer'],'networkTest':_0x58ead4[_0x2df12e(0xbf)]['networktest']})[_0x2df12e(0x85)]([_0x2df12e(0xa4),_0x2df12e(0x92)]);if(!_0x20f62a)return _0x359c1e[_0x2df12e(0xb9)](0x194)['send']('Response\x20not\x20found');_0x359c1e[_0x2df12e(0xa8)](_0x20f62a);});exports['viewMyComputerResponse']=viewMyComputerResponse;