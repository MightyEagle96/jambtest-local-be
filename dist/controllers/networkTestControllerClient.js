'use strict';const a13_0x58f382=a13_0x303f;(function(_0x2d86e4,_0x5d9877){const _0x5f2df4=a13_0x303f,_0x54798b=_0x2d86e4();while(!![]){try{const _0x109b6d=parseInt(_0x5f2df4(0x1fd))/0x1*(-parseInt(_0x5f2df4(0x1e9))/0x2)+-parseInt(_0x5f2df4(0x1de))/0x3*(-parseInt(_0x5f2df4(0x1f4))/0x4)+parseInt(_0x5f2df4(0x1c1))/0x5*(parseInt(_0x5f2df4(0x1f1))/0x6)+-parseInt(_0x5f2df4(0x1e8))/0x7*(-parseInt(_0x5f2df4(0x200))/0x8)+parseInt(_0x5f2df4(0x202))/0x9+-parseInt(_0x5f2df4(0x1c7))/0xa+parseInt(_0x5f2df4(0x1ec))/0xb*(-parseInt(_0x5f2df4(0x1c8))/0xc);if(_0x109b6d===_0x5d9877)break;else _0x54798b['push'](_0x54798b['shift']());}catch(_0x472b92){_0x54798b['push'](_0x54798b['shift']());}}}(a13_0x107f,0x46bc3));var __awaiter=this&&this['__awaiter']||function(_0x4bdd75,_0x1b0917,_0x52ba08,_0x438bf0){function _0x38b35e(_0x2ffd60){return _0x2ffd60 instanceof _0x52ba08?_0x2ffd60:new _0x52ba08(function(_0x1d8d53){_0x1d8d53(_0x2ffd60);});}return new(_0x52ba08||(_0x52ba08=Promise))(function(_0x396c9e,_0x309e75){const _0x61548e=a13_0x303f;function _0x2f6769(_0x3c203f){const _0x78f91f=a13_0x303f;try{_0x4302d8(_0x438bf0[_0x78f91f(0x1e1)](_0x3c203f));}catch(_0x69516b){_0x309e75(_0x69516b);}}function _0x2df3da(_0x126366){const _0x2d7b0f=a13_0x303f;try{_0x4302d8(_0x438bf0[_0x2d7b0f(0x1c9)](_0x126366));}catch(_0x243185){_0x309e75(_0x243185);}}function _0x4302d8(_0x380cc2){const _0x48c79e=a13_0x303f;_0x380cc2[_0x48c79e(0x1ea)]?_0x396c9e(_0x380cc2[_0x48c79e(0x1d6)]):_0x38b35e(_0x380cc2[_0x48c79e(0x1d6)])[_0x48c79e(0x1fb)](_0x2f6769,_0x2df3da);}_0x4302d8((_0x438bf0=_0x438bf0[_0x61548e(0x1c2)](_0x4bdd75,_0x1b0917||[]))[_0x61548e(0x1e1)]());});},__importDefault=this&&this[a13_0x58f382(0x1cd)]||function(_0x536dc8){return _0x536dc8&&_0x536dc8['__esModule']?_0x536dc8:{'default':_0x536dc8};};Object[a13_0x58f382(0x1ff)](exports,a13_0x58f382(0x1c6),{'value':!![]}),exports[a13_0x58f382(0x1c3)]=exports[a13_0x58f382(0x1fa)]=exports[a13_0x58f382(0x1e7)]=exports[a13_0x58f382(0x207)]=exports[a13_0x58f382(0x1c5)]=exports[a13_0x58f382(0x1f5)]=exports['viewNetworkTest']=void 0x0;const networkTest_1=__importDefault(require('../models/networkTest')),computerModel_1=__importDefault(require('../models/computerModel')),centreModel_1=__importDefault(require(a13_0x58f382(0x1f7))),DataQueue_1=require(a13_0x58f382(0x208)),networkTestResponse_1=__importDefault(require('../models/networkTestResponse')),questions_1=__importDefault(require(a13_0x58f382(0x1ef))),activeTestIntervals=new Map(),viewNetworkTest=(_0x3cfab0,_0x5611db)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x585842=a13_0x58f382,_0x36287c=yield networkTest_1[_0x585842(0x1c4)][_0x585842(0x1f9)](_0x3cfab0[_0x585842(0x1db)]['id']);if(!_0x36287c)return _0x5611db['status'](0x190)[_0x585842(0x20a)](_0x585842(0x1f3));_0x5611db[_0x585842(0x20a)](_0x36287c);});exports['viewNetworkTest']=viewNetworkTest;const errorMessages={'noCentre':a13_0x58f382(0x1d8),'noComputer':'Computer\x20not\x20yet\x20registered','noActiveTest':a13_0x58f382(0x1f6),'computerFlagged':a13_0x58f382(0x20b),'notUploaded':'This\x20computer\x20is\x20not\x20yet\x20registered\x20on\x20the\x20JAMB\x20test\x20network','alreadyTested':a13_0x58f382(0x1d2)},networkTestValidation=(_0x3c00f5,_0x186a86,_0xcaae0b)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x43457d=a13_0x58f382;var _0x4f9f7c,_0x3b5297;const _0x188a96=yield centreModel_1['default'][_0x43457d(0x1ca)](),_0x130e37=_0x3c00f5[_0x43457d(0x1e0)],_0x76818c=(_0x4f9f7c=_0x130e37[_0x43457d(0x1cb)])===null||_0x4f9f7c===void 0x0?void 0x0:_0x4f9f7c[_0x43457d(0x1fe)](),_0x3b70a=(_0x3b5297=_0x130e37[_0x43457d(0x1ce)])===null||_0x3b5297===void 0x0?void 0x0:_0x3b5297[_0x43457d(0x1fe)](),_0xeae10a=(_0x130e37['macAddresses']||[])['map'](_0x2279d4=>_0x2279d4[_0x43457d(0x1fe)]());if(!_0x188a96)return _0x186a86[_0x43457d(0x1fc)](0x190)['send'](errorMessages[_0x43457d(0x1ee)]);const _0x303533=yield computerModel_1['default']['findOne']({'$and':[{'serialNumber':_0x76818c},{'processorId':_0x3b70a},{'macAddresses':{'$in':_0xeae10a}}]});if(!_0x303533)return _0x186a86[_0x43457d(0x1fc)](0x190)[_0x43457d(0x20a)](errorMessages[_0x43457d(0x1dd)]);if(_0x303533['status']!==_0x43457d(0x1e6))return _0x186a86[_0x43457d(0x1fc)](0x190)['send'](errorMessages[_0x43457d(0x204)]);if(_0x303533['flagged'])return _0x186a86['status'](0x190)[_0x43457d(0x20a)](errorMessages[_0x43457d(0x1ed)]);const _0x241a80=yield networkTest_1['default']['findOne']({'active':!![]});if(!_0x241a80)return _0x186a86[_0x43457d(0x1fc)](0x190)[_0x43457d(0x20a)](errorMessages['noActiveTest']);if(_0x241a80){const _0x728663=yield networkTestResponse_1[_0x43457d(0x1c4)][_0x43457d(0x1ca)]({'computer':_0x303533[_0x43457d(0x1cf)]['toString'](),'networkTest':_0x241a80[_0x43457d(0x1cf)][_0x43457d(0x1da)](),'status':'ended'});if(_0x728663)return _0x186a86['status'](0x190)['send'](errorMessages[_0x43457d(0x206)]);}_0x3c00f5['headers']['computer']=_0x303533[_0x43457d(0x1cf)][_0x43457d(0x1da)](),_0x3c00f5['headers']['networktest']=_0x241a80[_0x43457d(0x1cf)][_0x43457d(0x1da)](),_0xcaae0b();});exports[a13_0x58f382(0x1f5)]=networkTestValidation;const dataQueue=new DataQueue_1[(a13_0x58f382(0x1e5))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),beginNetworkTest=(_0x2b9924,_0x244fbd)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x285ce6=a13_0x58f382;_0x244fbd[_0x285ce6(0x20a)]({'networkTest':_0x2b9924['headers']['networktest'],'computer':_0x2b9924[_0x285ce6(0x1d7)]['computer']}),dataQueue[_0x285ce6(0x1bf)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x6eccf0=_0x285ce6,_0x2ee08f=yield networkTest_1[_0x6eccf0(0x1c4)]['findById'](_0x2b9924[_0x6eccf0(0x1d7)][_0x6eccf0(0x1f8)]),_0x18ba0a=yield networkTestResponse_1[_0x6eccf0(0x1c4)][_0x6eccf0(0x1ca)]({'computer':_0x2b9924[_0x6eccf0(0x1d7)][_0x6eccf0(0x1e2)],'networkTest':_0x2b9924[_0x6eccf0(0x1d7)][_0x6eccf0(0x1f8)]});!_0x18ba0a&&_0x2ee08f&&(yield networkTestResponse_1[_0x6eccf0(0x1c4)]['create']({'computer':_0x2b9924['headers']['computer'],'networkTest':_0x2b9924['headers'][_0x6eccf0(0x1f8)],'ipAddress':_0x2b9924['ip'],'responses':0x0,'timeLeft':_0x2ee08f[_0x6eccf0(0x1f0)],'loggedInAt':new Date()}));}));});exports['beginNetworkTest']=beginNetworkTest;const responseQueue=new DataQueue_1['ConcurrentJobQueue']({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),sendResponses=(_0x1c4448,_0x4607c7)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x57d1db=a13_0x58f382;try{const _0x2b701b=yield networkTest_1[_0x57d1db(0x1c4)]['findOne']({'active':!![]});if(!_0x2b701b)return _0x4607c7[_0x57d1db(0x1d0)](0x194);yield responseQueue[_0x57d1db(0x1bf)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4ac458=_0x57d1db,{computer:_0x249942,networktest:_0x30fc18,timeLeft:_0x4e2e04}=_0x1c4448[_0x4ac458(0x1e0)],_0x51efcd=yield networkTest_1[_0x4ac458(0x1c4)]['findById'](_0x30fc18);if(!_0x51efcd)return console['log'](_0x4ac458(0x1cc),_0x30fc18),_0x4607c7[_0x4ac458(0x1fc)](0x194)[_0x4ac458(0x20a)](_0x4ac458(0x1df));const _0x482607=yield networkTestResponse_1['default'][_0x4ac458(0x1ca)]({'computer':_0x249942,'networkTest':_0x30fc18});if(!_0x482607)return _0x4607c7[_0x4ac458(0x1fc)](0x194)['send']({'message':_0x4ac458(0x203)});_0x482607['responses']+0x1<=_0x51efcd['maxResponses']&&(_0x482607[_0x4ac458(0x201)]+=0x1),_0x482607[_0x4ac458(0x1d4)]=_0x4e2e04,_0x482607[_0x4ac458(0x1fc)]=_0x4ac458(0x1e3),yield _0x482607['save'](),_0x4607c7[_0x4ac458(0x20a)](_0x4ac458(0x205));}));}catch(_0x9e6b94){console[_0x57d1db(0x1d1)](_0x57d1db(0x1d3),_0x9e6b94),_0x4607c7[_0x57d1db(0x1fc)](0x1f4)[_0x57d1db(0x20a)]({'message':'Server\x20error'});}});exports['sendResponses']=sendResponses;const questionAndResponseCount=(_0x125f24,_0x469612)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3128bc=a13_0x58f382,[_0xe66a5c,_0x55a50d]=yield Promise[_0x3128bc(0x1be)]([networkTestResponse_1[_0x3128bc(0x1c4)][_0x3128bc(0x1ca)]({'computer':_0x125f24[_0x3128bc(0x1e0)][_0x3128bc(0x1e2)],'networkTest':_0x125f24[_0x3128bc(0x1e0)][_0x3128bc(0x1f8)]}),networkTest_1['default'][_0x3128bc(0x1f9)](_0x125f24[_0x3128bc(0x1e0)][_0x3128bc(0x1f8)])]);if(!_0xe66a5c)return _0x469612['status'](0x194)['send'](_0x3128bc(0x209));if(!_0x55a50d)return _0x469612[_0x3128bc(0x1fc)](0x194)[_0x3128bc(0x20a)](_0x3128bc(0x1f3));function _0x50952a(){const _0x2d0189=_0x3128bc,_0x43e8b0=Math[_0x2d0189(0x1e4)](Math['random']()*questions_1[_0x2d0189(0x1c4)][_0x2d0189(0x1f2)]);return questions_1[_0x2d0189(0x1c4)][_0x43e8b0];}_0x469612[_0x3128bc(0x20a)](Object['assign'](Object[_0x3128bc(0x1eb)]({},_0x50952a()),{'responses':_0xe66a5c[_0x3128bc(0x201)],'maxResponses':_0x55a50d['maxResponses']}));});function a13_0x303f(_0x4524c5,_0x389644){const _0x107fd9=a13_0x107f();return a13_0x303f=function(_0x303f4e,_0x23b120){_0x303f4e=_0x303f4e-0x1be;let _0x156837=_0x107fd9[_0x303f4e];return _0x156837;},a13_0x303f(_0x4524c5,_0x389644);}exports[a13_0x58f382(0x1e7)]=questionAndResponseCount;const endQueue=new DataQueue_1[(a13_0x58f382(0x1e5))]({'concurrency':0x1,'maxQueueSize':0x64,'retries':0x0,'retryDelay':0xbb8,'shutdownTimeout':0x7530}),endNetworkTest=(_0x34701a,_0x407dbd)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x48acbb=a13_0x58f382,_0xbaec4a=yield networkTest_1[_0x48acbb(0x1c4)][_0x48acbb(0x1ca)]({'active':!![]});if(!_0xbaec4a)return _0x407dbd[_0x48acbb(0x1d0)](0x194);endQueue[_0x48acbb(0x1bf)](()=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x53637f=_0x48acbb,{computer:_0x26692a,networktest:_0xbcfbc}=_0x34701a[_0x53637f(0x1e0)],_0x1d3988=yield networkTest_1['default'][_0x53637f(0x1f9)](_0xbcfbc);if(!_0x1d3988)return console['log'](_0x53637f(0x1cc),_0xbcfbc),_0x407dbd[_0x53637f(0x1d0)](0x194);const _0x227c28=yield networkTestResponse_1[_0x53637f(0x1c4)][_0x53637f(0x1ca)]({'computer':_0x26692a,'networkTest':_0xbcfbc});if(!_0x227c28)return _0x407dbd[_0x53637f(0x1d0)](0x194);_0x227c28[_0x53637f(0x201)]+0x1<=_0x1d3988[_0x53637f(0x1c0)]&&(_0x227c28[_0x53637f(0x201)]+=0x1),_0x227c28[_0x53637f(0x1d4)]=0x0,_0x227c28['status']=_0x53637f(0x1d5),yield _0x227c28[_0x53637f(0x1d9)](),_0x407dbd[_0x53637f(0x20a)](_0x53637f(0x205));}));});exports['endNetworkTest']=endNetworkTest;const viewMyComputerResponse=(_0x47c493,_0x3cd5d7)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x59f6=a13_0x58f382,_0x119b2d=yield networkTestResponse_1[_0x59f6(0x1c4)][_0x59f6(0x1ca)]({'computer':_0x47c493[_0x59f6(0x1d7)][_0x59f6(0x1e2)],'networkTest':_0x47c493[_0x59f6(0x1d7)][_0x59f6(0x1f8)]})[_0x59f6(0x1dc)](['networkTest',_0x59f6(0x1e2)]);if(!_0x119b2d)return _0x3cd5d7['status'](0x194)[_0x59f6(0x20a)](_0x59f6(0x209));_0x3cd5d7[_0x59f6(0x20a)](_0x119b2d);});function a13_0x107f(){const _0x54a43c=['sendResponses','./DataQueue','Response\x20not\x20found','send','This\x20computer\x20has\x20been\x20flagged\x20for\x20an\x20infraction','all','enqueue','maxResponses','5gjGHAK','apply','viewMyComputerResponse','default','beginNetworkTest','__esModule','2690190BSdxwK','24NkpiQG','throw','findOne','serialNumber','No\x20matching\x20test\x20found\x20for:','__importDefault','processorId','_id','sendStatus','error','This\x20computer\x20has\x20already\x20been\x20tested','Error\x20in\x20sendResponses:','timeLeft','ended','value','headers','No\x20centre\x20found,\x20contact\x20administrator','save','toString','params','populate','noComputer','13758jrciNB','No\x20matching\x20test\x20found','body','next','computer','connected','floor','ConcurrentJobQueue','uploaded','questionAndResponseCount','1993649daHOCr','34WWWGkV','done','assign','5282442JEyoUr','computerFlagged','noCentre','./questions','duration','3391482cvOpmY','length','Test\x20not\x20found','116RIFCng','networkTestValidation','There\x20is\x20no\x20active\x20network\x20test','../models/centreModel','networktest','findById','endNetworkTest','then','status','13961ZfSADe','toLowerCase','defineProperty','16wBtYxM','responses','4398084zbWVkp','No\x20matching\x20response\x20found','notUploaded','Success','alreadyTested'];a13_0x107f=function(){return _0x54a43c;};return a13_0x107f();}exports['viewMyComputerResponse']=viewMyComputerResponse;